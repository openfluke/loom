<!DOCTYPE html>
<html>
  <head>
    <title>Memory64 Test</title>
  </head>
  <body>
    <h1>WASM Memory Detection</h1>
    <div id="result">Testing...</div>

    <script>
      async function testMemory64() {
        const result = document.getElementById("result");

        try {
          // Try to compile a minimal Memory64 module
          const memory64Test = new Uint8Array([
            0x00,
            0x61,
            0x73,
            0x6d, // magic: \0asm
            0x01,
            0x00,
            0x00,
            0x00, // version: 1
            0x05,
            0x04,
            0x01, // memory section
            0x04,
            0x00,
            0x01, // memory64: min=1
          ]);

          await WebAssembly.compile(memory64Test);
          result.innerHTML = `
                <h2 style="color: green;">✅ Memory64 SUPPORTED!</h2>
                <p>Your browser supports WebAssembly Memory64.</p>
                <p><strong>You can load ANY model size!</strong></p>
                <ul>
                    <li>Qwen 2.5-0.5B ✅</li>
                    <li>TinyLlama-1.1B ✅</li>
                    <li>Larger models ✅</li>
                </ul>
            `;
        } catch (e) {
          result.innerHTML = `
                <h2 style="color: orange;">⚠️ Memory64 NOT supported</h2>
                <p>Your browser does not support WebAssembly Memory64.</p>
                <p><strong>Stick to smaller models:</strong></p>
                <ul>
                    <li>SmolLM2-360M ✅</li>
                    <li>Pythia-410M ✅</li>
                    <li>Qwen 2.5-0.5B ⚠️ (may fail)</li>
                </ul>
                <p><strong>Browsers with Memory64:</strong></p>
                <ul>
                    <li>Chrome 119+</li>
                    <li>Edge 119+</li>
                </ul>
                <p>Error: ${e.message}</p>
            `;
        }
      }

      testMemory64();
    </script>
  </body>
</html>
